<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	template="/templates/template-general.xhtml">

	<ui:define name="titulo">ShareMyTrip-Casa
	</ui:define>

	<ui:define name="menubar">
		<p:menubar>
			<p:menuitem value="ShareMyTrip" disabled="true">
			</p:menuitem>
			<p:menuitem value="Ver viajes" action="#{viajes.listadoDetalle}">
			</p:menuitem>
			<p:menuitem style="position:absolute;right:10px;" value="Cerrar Sesión"
				action="#{login.cerrarSesion}">
			</p:menuitem>
		</p:menubar>
	</ui:define>
	<ui:define name="cuerpo">
		<br/><br/>
		<p:dataTable id="table" var="var" value="#{viajes.tripsWithRelation}" style="width:100%">
			<f:facet name="header">Viajes del usuario</f:facet>
			<p:column>
				<f:facet name="header">Identificador</f:facet>#{var.trip.id}</p:column>
			<p:column>
				<f:facet name="header">Fecha de cierre</f:facet>
				<h:outputText value="#{var.trip.closingDate}">
				<f:convertDateTime pattern="EEE d/MMM/yyyy  HH:mm:ss"/>
				</h:outputText></p:column>
			<p:column>
				<f:facet name="header">Relacion</f:facet>#{var.relacion}</p:column>
			<p:column>
				<p:commandLink id="cancelarSolicitud" rendered="#{var.relacion eq 'PENDIENTE DE CONFIRMACIÓN'}"
				value="Cancelar Solicitud" action="#{solicitudes.eliminar(var)}" update="table"/>
				<p:commandLink id="cancelarPlaza" rendered="#{var.relacion eq 'ADMITIDO' 
				or var.relacion eq 'EXCLUIDO'}" value="Cancelar Plaza"/>
				<p:commandLink id="gestionarSolicitudes" rendered="#{var.relacion eq 'PROMOTOR'}"
				 value="Gestionar solicitudes" action="verSolicitudes" 
				 actionListener="#{sessionuser.cargarSolicitantes(var.trip)}"/>
				<br/>
				<p:commandLink id="gestionarPlazas" rendered="#{var.relacion eq 'PROMOTOR'}"
				 value="Gestionar plazas" action="verPasajerosConPlaza" 
				 actionListener="#{sessionuser.cargarPasajerosAdmitidos(var.trip)}"/></p:column>
		</p:dataTable>
	</ui:define>
	<ui:define name="pie">
		<ui:include src="/snippets/footer.xhtml" />
	</ui:define>
</ui:composition>